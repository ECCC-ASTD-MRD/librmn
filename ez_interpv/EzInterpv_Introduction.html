 <!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
  <head>
    <title>Untitled Document</title>
    <link rel="stylesheet" href="http://iweb.cmc.ec.gc.ca/rpn/css/goc.css" type="text/css">
  </head>
  <body>
    <table BORDER=0 WIDTH="100%" >
      <tr><!row>
        <td WIDTH="33%"><!column>
          <h2><!font>RMNLIB</h2>
        </td>
        <td ALIGN=CENTER WIDTH="34%">
          <h2>(EZINTERPV PACKAGE INTRODUCTION)</h2>
        </td>
        <td ALIGN=RIGHT WIDTH="33%">
          <!although empty, column needed to align others>
        </td>
      </tr>
    </table>
    <br><!line break>

<p class=text><!paragraph>
EzInterpv is just a front end to the Interp1D package.  Therefore, to understand the basic intent of EzInterpv, please refer to the <a href=../Interp1D_Introduction.html>Interp1D introduction</a>.  The interface to EzInterpv has been designed to resemble that of the ezscint package.  Most of the functionality of the Interp1D package is available through the EzInterpv interface.  The advantage of using EzInterpv is that multiple interpolations are automated, using an interface with a familiar feel.
</p>

<p class=text> 
<b>PURPOSE:</b>
</p>
<p class=text>
The vertical interpolation package performs interpolations in one dimension, using the 1D interpolation package for the basic interpolation routines.  Many interpolations that are completely independent, aside from using the same co-ordinates, are stacked together in a second dimension and are performed in one pass through the facility.  For all but the 'generic',  gridType, the interpolation / extrapolation is linear in Ln(P); this yields better interpolations with meteorological data.  For the 'surface' and 'surfacewind' extrapolation types, the EXTRApolation is linear in Z.</p>

<p class=text> 
<b>SETS OF INTERPOLATIONS:</b>
</p>
<p class=text style="margin-left: 1em">
<span style="text-indent: -1em">i.<br></span>
A single point is interpolated from the values at the many vertical levels at a single horizontal co-ordinate.  Use N_ViqkdefIfc_X(numVLevels=1, ...)  N_VidefsetIfc_X(hNumPts=1, ...) 
<br>
<span style="text-indent: -1em">ii.<br></span>
Several points at different vertical levels (and a single horizontal co-ordinate) can be interpolated from a single set of values at the many vertical levels at a single horizontal co-ordinate.  Use N_ViqkdefIfc_X(numVLevels=n, ...)  N_VidefsetIfc_X(hNumPts=1, ...)  
<br>
<span style="text-indent: -1em">iii.<br></span>
The interpolation set ii can be repeated at many horizontal co-ordinates all in the same run.  The vertical levels at which input values are supplied are constant for each horizontal co-ordinate, except for the adjustment to P<sub>s</sub> at each horizontal location; the vertical levels at which output values are interpolated are also constant for each horizontal co-ordinate (Where the z-values are specified for these levels, using the extended interface, the values must be repeated for each horizontal location).  Otherwise, each horizontal co-ordinate is independent of the others.  Use N_VidefsetIfc_X(hNumPts=m, ...) 
<br>
<span style="text-indent: -1em">iv.<br></span>
The interpolation set iii can be repeated for several observable properties.  This requires calling N_VisintIfc_X() once for each observable property.  However, the calls to N_ViqkdefIfc() and N_VidefsetIfc_X() need not be repeated. 
</p>

<p class=text> 
<b>USE OF THE SOFTWARE:</b>
</p>
<p class=text style="margin-left: 1em">
<span style="text-indent: -1em">1.</span>
While it is not mandatory, your life will be easier if your code 'include's two files (r.compile will find them):<br>
<span style="margin-left: 3em">
    #include &lt ViConstants_f90.h &gt, which defines some handy constants<br>
    #include &lt VertInterp_f90.h &gt, which declares the functions and defines their interfaces<br>
</span>
<span style="text-indent: -1em">2.</span>
  Define the vertical grid (co-ordinates) of the input data.  Use N_ViqkdefIfc_X, the grid constructor.<br> 
<span style="text-indent: -1em">3.</span>
  Define the vertical grid of the output data.  Again, use N_ViqkdefIfc_X. <br>
<span style="text-indent: -1em">4.</span>
  Tell the interpolator which input and output grids you want to use and define the horizontal grid including some physical parameters on that grid.  Use N_VidefsetIfc_X and the indices returned in steps 2 and 3. <br>
<span style="text-indent: -1em">5.</span>
  Tell the interpolator which interpolation algorithm you want to use.  Use N_VisetoptIfc. <br>
<span style="text-indent: -1em">6.</span>
  To perform the interpolation, use N_VisintIfc_X. <br><br>
<span style="text-indent: -1em">N.B.: </span>
  The extended interface is described in this document.  The original interface (functions without the _X suffix in their names, without the ExtArrays parameters, and using actual vertical-grid structures instead of indices) will continue to be supported, but is not explicitly documented.  Furthermore, THE ORIGINAL INTERFACE IS DEPRECATED. <br>
<span style="text-indent: -1em">N.B.: </span>
  The beta revision of the library (rmnbeta) is required at the time of writing.  Revision rmn_008 will also work, once it is released.  Revision rmn_007 will also work (except on azur), if the extended interface is not used; in this case '#include &lt ViTypes_f90.h &gt; instead of 'use ViTypes'.
</p>

<p class=text><b>CAVEATS:</b></p>
<p class=text style="margin-left: 1em">
<span style="text-indent: -1em">- </span>The grid that contains the known observable values must be ordered:  either ascending or descending vertical levels.<br>
<span style="text-indent: -1em">- </span>For a grid that has the vertical levels in hybrid units, the first vertical level must be the top level.  If this is combined with the previous condition, this means that the vertical levels must be in descending order.  Although really subject only to the constraints already mentioned (source grid in hybrid units), it would be safe always to have the vertical levels in descending order.  The source of this constraint is the function, hybrid_to_pres, that is used to convert from hybrid units. <br>
<span style="text-indent: -1em">- </span>It can be noted that in the case where the vertical levels are exactly the same, the software explicitly does nothing (as opposed to performing the interpolation which should give exactly the same result).<br>
<span style="text-indent: -1em">- </span>This package cannot be called from fortran77 using the unextended interface.  Fortran77 users must either use the extended interface or else access directly the Interp1D routines on which ez_interpv is based.
</p>

<p class=text><b>ERROR VALUES:</b></p>
<p class=text>
Values that are returned as error indications can be found in $ARMNLIB/include/ViConstants_f90.h (This is a copy of the values actually compiled, in VertInterpConstants.cdk90).  A value of 0 means that there is no error.  The values are:<br>
<pre class=text>
    ! errors from the VerticalInterpolation class
        integer, parameter :: N_VI_VIERR_FAILED_ALLOCATION    =100, & 
                              N_VI_VIERR_UNDEFINED_GRID_REQD  =101, & 
                              N_VI_VIERR_GRIDS_NOT_SELECTED   =102, & 
                              N_VI_VIERR_BAD_INTERPTYP_4_DATA =103, & 
                              N_VI_VIERR_UNRECOGNIZED_OPTION  =104, & 
                              N_VI_VIERR_UNRECOGNIZED_VALUE   =105, & 
                              N_VI_VIERR_LN_PRESS_CONVERSION  =106, & 
                              N_VI_VIERR_MISSING_SURFACE_DATA =108, &

    ! errors from VerticalGrid class 
                              N_VI_VGERR_HYBRID_TO_PRES_CONVN =200, & 
                              N_VI_VGERR_FAILED_ALLOCATION    =201, & 
                              N_VI_VGERR_PTOP_MISSING         =202, &

  ! errors from the Interface routines
                              N_IFC_VGRID_REPOSITORY_OVERFLOW =300, &
                              N_IFC_REPOSITORY_INVALID_INDEX  =301, &
                              N_IFC_INVALID_DIMENSION         =302
</pre>

<p>

<hr WIDTH="100%">
<br><a href="../../../../index.html">Return to RPN home page</a>
<br><a href="index.html">Return to product index</a>
<br>			Last updated: <csobj w=200 h=16 t=DateTime locale=00000409 format=LongDate region=0>December 5, 2003</csobj></p>
  </body>
</html>
