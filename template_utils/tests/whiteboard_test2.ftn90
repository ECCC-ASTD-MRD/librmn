!copyright (C) 2007  MSC-RPN COMM  %%%MEC%%%
!**s/r 
!APIBEGIN
program wb_test2
  implicit none
!APIEND
!
!object
!  test fn for the whiteboard and its fortran interface
!author
!  Stephane Chamberland, 2007-08
!revision
!implicits
#include "rmnlib.hf"
!externals
!** end of rpn-doc sections
  integer, parameter :: MAX_MODELS  = 99
  integer, parameter :: MAX_FIELDS  = 999

  character(len=WB_MAXSTRINGLENGTH) :: myname, model_list(MAX_MODELS),label,match,fldname,options
  character(len=WB_MAXSTRINGLENGTH),dimension(MAX_FIELDS) :: tmp_flds,in_flds,out_flds,tot_flds,keys
  integer :: i,j,err0,err,n_tmp_flds,n_in_flds,n_out_flds,n_tot_flds,n_modeles,nkeys
  !---------------------------------------------------------------------
  err = wb_verbosity(WB_MSG_DEBUG)
  !err = wb_verbosity(WB_MSG_ERROR)

  n_modeles = 0
  n_modeles = n_modeles + 1
  model_list(n_modeles) = 'input'
  options='io=o'
  err = wb_put('input/f/o/P0',options)
  options='io=o ; timeflag=-'
  err = wb_put('input/f/o/UU:-',options)
  options='io=o ; timeflag=+'
  err = wb_put('input/f/o/UU:+',options)

  n_modeles = n_modeles + 1
  model_list(n_modeles) = 'gem'
  options='io=i'
  err = wb_put('gem/f/i/P0',options)
  options='io=io ; timeflag=-'
  err = wb_put('gem/f/io/UU:-',options)
  options='io=io ; timeflag=+'
  err = wb_put('gem/f/oi/UU:+',options)
  options='io=o'
  err = wb_put('gem/f/o/DD',options)
  err = wb_put('gem/f/o/QR',options)

  n_modeles = n_modeles + 1
  model_list(n_modeles) = 'output'
  options='io=i'
  err = wb_put('output/f/i/P0',options)
  options='io=i ; timeflag=-'
  err = wb_put('output/f/i/UU:-',options)
  options='io=i ; timeflag=+'
  err = wb_put('output/f/i/UU:+',options)
  options='io=i'
  err = wb_put('output/f/i/DD',options)


  do i=1,n_modeles
     label = trim(model_list(i))//'/f/'
     err = wb_keys(keys,nkeys,label)
     print *,i,trim(label),nkeys,err
     do j=1,nkeys
        err = wb_get(trim(keys(j)),options)
        print '(I,A20," = ",A)',j,trim(keys(j)),trim(options)
     enddo
  enddo

  err = wb_check('',-1)

end program wb_test2
