
program wb_test5
   call test_wb_sub_write()
   call test_wb_sub_read2()
   call test_wb_sub_read()
   call test_wb_sub_read1()
end program wb_test5


subroutine test_wb_sub_write()
   implicit none
#include <WhiteBoard.hf>
   integer :: istat,options
   character(len=WB_MAXSTRINGLENGTH):: gmmk_max
   character(len=41):: gmmk_41
   character(len=8) :: gmmk_xth_s

   options = WB_REWRITE_NONE+WB_IS_LOCAL

   gmmk_max   = '12345678901234567890123456789012345678901'
   gmmk_41    = '12345678901234567890123456789012345678901'
   gmmk_xth_s = '12345678'

   istat = wb_put('model/gmm/max',gmmk_max,options)
   print *,'put  gmmk_max  =',gmmk_max,'=',len(gmmk_max),istat

   istat = wb_put('model/gmm/xth41',gmmk_41,options)
   print *,'put  gmmk_xth41=',gmmk_41,'=',len(gmmk_41),istat

   istat = wb_put('model/gmm/xth_m',gmmk_xth_s,options)
   print *,'put  gmmk_xth_s=',gmmk_xth_s,'=',len(gmmk_xth_s),istat

end subroutine test_wb_sub_write


subroutine test_wb_sub_read()
   implicit none
#include <WhiteBoard.hf>
   integer :: istat,type1,typelen,array_size,options
   character(len=WB_MAXSTRINGLENGTH):: gmmk_max
   character(len=8) :: gmmk_xth_s
   character(len=41) :: gmmk_41

   istat = wb_get_meta('model/gmm/max',type1,typelen,array_size,options)
   print *,'get  metamax=',type1,typelen,array_size,options,'=',istat
   istat = wb_get('model/gmm/max',gmmk_max)
   print *,'get  gmmk_max  =',gmmk_max,'=',istat

   istat = wb_get_meta('model/gmm/xth41',type1,typelen,array_size,options)
   print *,'get  meta41 =',type1,typelen,array_size,options,'=',istat
   istat = wb_get('model/gmm/xth41',gmmk_41)
   print *,'get  gmmk_xth41=',gmmk_41,'=',istat

   istat = wb_get_meta('model/gmm/xth_m',type1,typelen,array_size,options)
   print *,'get  meta8  =',type1,typelen,array_size,options,'=',istat
   istat = wb_get('model/gmm/xth_m',gmmk_xth_s)
   print *,'get  gmmk_xth_s=',gmmk_xth_s,'=',istat

end subroutine test_wb_sub_read

subroutine test_wb_sub_read1()
   implicit none
#include <WhiteBoard.hf>
   integer :: istat
   character(len=6) :: gmmk_xth_s
   istat = wb_get('model/gmm/xth_m',gmmk_xth_s)
   print *,'get1 gmmk_xth_s=',gmmk_xth_s,'=',istat
end subroutine test_wb_sub_read1

subroutine test_wb_sub_read2()
   implicit none
#include <WhiteBoard.hf>
   integer :: istat
   character(len=WB_MAXSTRINGLENGTH) :: gmmk_xth_s,gmmk_41,gmmk_max

   istat = wb_get('model/gmm/max',gmmk_max)
   print *,'get2 gmmk_max  =',trim(gmmk_max),'=',istat

   istat = wb_get('model/gmm/xth41',gmmk_41)
   print *,'get2 gmmk_xth41=',trim(gmmk_41),'=',istat

   istat = wb_get('model/gmm/xth_m',gmmk_xth_s)
   print *,'get2 gmmk_xth_s=',trim(gmmk_xth_s),'=',istat
   print *,'get2 gmmk_xth_s=',gmmk_xth_s,'=',istat
end subroutine test_wb_sub_read2
