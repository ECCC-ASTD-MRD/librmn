set(CTEST_OUTPUT_ON_FAILURE ON FORCE)
include(CTest)
if(BUILD_TESTING)
    add_executable(clib_isalpha ${CMAKE_CURRENT_SOURCE_DIR}/clib_isalpha.F90)
    target_link_libraries(clib_isalpha rmn)
    add_test(NAME clib_isalpha COMMAND ${CMAKE_CURRENT_BINARY_DIR}/clib_isalpha ${CMAKE_CURRENT_SOURCE_DIR}/spp.dict)

    foreach(DATATYPE float double)
        add_executable(fst_${DATATYPE} ${CMAKE_CURRENT_SOURCE_DIR}/fst.c)
        target_compile_definitions(fst_${DATATYPE} PRIVATE DATATYPE=${DATATYPE})
        target_link_libraries(fst_${DATATYPE} PRIVATE rmn)
        add_test(NAME fst_${DATATYPE} COMMAND ${CMAKE_CURRENT_BINARY_DIR}/fst_${DATATYPE})
    endforeach()

    add_executable(wb_read ${CMAKE_CURRENT_SOURCE_DIR}/wb_read.F90)
    target_link_libraries(wb_read rmn)
    add_test(NAME wb_read COMMAND ${CMAKE_CURRENT_BINARY_DIR}/wb_read ${CMAKE_CURRENT_SOURCE_DIR}/spp.dict)
endif()
